{%- style -%}
  #shopify-section-{{ section.id }} {
    position: relative;
    --section-padding-top: {{ section.settings.padding_top }}px;
    --section-padding-bottom: {{ section.settings.padding_bottom }}px;
    --image-position: {{ section.settings.image_position }};
      --gradient-background: {% if section.settings.gradient_background != blank %}{{ section.settings.gradient_background }}{% else %}{{ section.settings.colors_background }}{% endif %};
      --color-background: {{ section.settings.colors_background.red }}, {{ section.settings.colors_background.green }}, {{ section.settings.colors_background.blue }};
      --color-foreground: {{ section.settings.colors_text.red }}, {{ section.settings.colors_text.green }}, {{ section.settings.colors_text.blue }};
      --color-link: var(--color-foreground);
      --color-border: var(--color-foreground);
      --color-heading: var(--color-foreground);
      background: var(--gradient-background);
      background-color: rgb(var(--color-background));
    --card--color: {{section.settings.card_colors_text.red}},{{section.settings.card_colors_text.green}},{{section.settings.card_colors_text.blue}};
    --card--background: {{section.settings.card_colors_background.red}},{{section.settings.card_colors_background.green}},{{section.settings.card_colors_background.blue}};
  }
  #shopify-section-{{ section.id }} .review--slide{
   background-color:{{section.settings.revv_bg }};
   color:{{section.settings.revv_text }};

  }
  .rsv-swiper-slide:first-child {
    margin-left: 2rem;
  }
  .rsv-swiper-slide{
    height:auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .review--slide {
    display: flex;
    height:100%;
    padding:2rem;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-radius:15px;
    gap: 1.5rem;
  }

  .review--slide-author {
    max-width: 95px;
  }
  .review--slide-author img {
    width:100%;
    height:100%;
  }

  @media screen and (max-width: 749px){
    #shopify-section-{{ section.id }} .section--padding{
      padding-top: {{section.settings.mob_padding_top}}px;
      padding-bottom: {{section.settings.mob_padding_bottom}}px;
    }
    .rsv-swiper-slide:first-child {
      margin-left:0;
    }
  
  }
{%- endstyle -%}
<div class="reviews--slider section--padding">
  <div class="{% if section.settings.page_width %}page-width{% else %}review-slider{% endif %}">
    <div class="review--slider--wrapper">
      <div class="section--review-header__wrapper">
        <div class="review--header__main">
          <div class="title-wrapper{% if section.settings.heading == blank %} title-wrapper--no-heading{% endif %} {{ section.settings.heading_alignment }} mobile-{{ section.settings.mobile_text_alignment }}">
            <{{ section.settings.heading_tag }} class="title {{ section.settings.heading_size }}">{{ section.settings.heading | escape }}</{{ section.settings.heading_tag }}>
            {% if section.settings.rs_description != blank %}
            <span class="rs-description">{{ section.settings.rs_description }}</span>
            {% endif %}
          </div>
          {% if section.settings.trust_image != blank %}
            <div id="review--trust__image-{{ section.id }}" class="review--trust__image {{ section.settings.heading_alignment }} mobile-{{ section.settings.mobile_text_alignment }}">
              <style>
                review--trust__image-{{ section.id }}{
                  height: {{section.settings.trust_image_height}}px;
                }
              </style>
              {% assign image_height = section.settings.trust_image_height | plus: 20 %}
              {% if section.settings.image_url != blank %}
                <a href="{{ section.settings.image_url }}">
              {% endif %}
                <img src="{{ section.settings.trust_image | image_url: height: image_height }}" alt="Trust pilot reviews" width="200" height="36" loading="lazy">
              {% if section.settings.image_url != blank %}
                </a>
              {% endif %}
            </div>
          {% endif %}
        </div>
        {% comment %} <div class="arrow__box mobile-hide small-hide">
          <div class="swiper-button-prev"><div class="visually-hidden"></div></div>
          <div class="swiper-button-next"><div class="visually-hidden"></div></div>
        </div> {% endcomment %}
      </div>
      {% if section.blocks.size > 0 %}
        <div class="review--slider--main">
          <div class="reviews--slider--wrapper">
            <div class="review--slider swiper">
              <div class="swiper-wrapper">
                {% for block in section.blocks %}
                  <div class="rsv-swiper-slide swiper-slide">
                    <div class="review--slide">
                      {% if block.settings.icon != blank or block.settings.product_image != blank %}
                        <div class="review--slide--upper__wrapper">
                          {% if block.settings.icon != blank %}
                            <div class="review--slide-author"><img src="{{ block.settings.icon | image_url: width: 200}}" width="200" height="50" loading="lazy" alt="icon"></div>
                          {% endif %}
                          {% if block.settings.product_image != blank %}
                            <div class="review--slider-product-image">
                              <img src="{{ block.settings.product_image | image_url: width: 120 }}" alt="{{ block.settings.product_title | handle }}-image" width="80" height="80" loading="lazy">
                            </div>
                          {% endif %}
                        </div>
                      {% endif %}
                      {% if block.settings.text != blank %}
                        <div class="review--slide-text rte {{ block.settings.text_size }}">{{ block.settings.text }}</div>
                      {% endif %}
                      {% if block.settings.image != blank or block.settings.author_title != blank or block.settings.verify != blank %}
                        <div class="review--slide-author-header">
                          {% if block.settings.author_title != blank or block.settings.verify != blank %}
                          <div class="review--slide-author-detail">
                            {% if block.settings.author_title != blank %}
                              <div class="review--slide-author-title typeset">{{ block.settings.author_title }}</div>
                            {% endif %}
                            {% if block.settings.product_title != blank or block.settings.button_label != blank %}
                              <div class="review--slide-product-info">
                                {% if block.settings.product_title != blank %}
                                  <span class="review--slide-product-title typeset0">{{ block.settings.product_title }}</span>
                                {% endif %}
                                {% if block.settings.button_label != blank %}
                                  <a class="typeset0 review--slide-button"{% if block.settings.button_link != blank %} href="{{ block.settings.button_link }}"{% else %} role="button" aria-disabled="true"{% endif %}>{{ block.settings.button_label }}</a>
                                {% endif %}
                              </div>
                            {% endif %}
                          </div>
                          {% endif %}
                        </div>
                      {% endif %}
                    </div>
                  </div>
                {% endfor %}
              </div>
              {% comment %} <div class="arrow__box desktop-hide large-up-hide medium-hide">
                <div class="swiper-button-prev"><div class="visually-hidden"></div></div>
                <div class="swiper-button-next"><div class="visually-hidden"></div></div>
              </div> {% endcomment %}
            </div>
          </div>
        </div>
      {% endif %}
      
    </div>
  </div>
</div>
<script>
  window.addEventListener("DOMContentLoaded", function () {
    /*******REVIEWS SLIDER FUNCTIONALITY****/
    const reviewSlider = new Swiper("#shopify-section-{{ section.id }} .review--slider", {
      spaceBetween: 20,
      centeredSlides: true, // ✅ Important for centering partial slides
      loop: true,
      speed: 1000,

      autoplay: {
        delay: 3000,
        reverseDirection: {{section.settings.swiper_direction}}, 
        disableOnInteraction: true,
      },

      breakpoints: {
        0: {
          slidesPerView: 1.2,   // ✅ 1.2 slides per view
          spaceBetween: 10,
          centeredSlides: true, // ✅ Center slide with partials on both sides
        },
        749: {
          slidesPerView: 2,
          spaceBetween: 10,
          centeredSlides: false, // ✅ turn off centering on larger screens
        },
        990: {
          slidesPerView: 3,
          spaceBetween: 15,
          centeredSlides: false,
        },
        1200: {
          slidesPerView: {{section.settings.column_num }},
          spaceBetween: 20,
          centeredSlides: false,
        },
      },
    });
  });
</script>

{% schema %}
  {
    "name": "Reviews Column v1",
    "settings": [
      {
        "type": "checkbox",
        "id": "page_width",
        "label": "Enable Page Width",
        "default":true
      },
      {
        "type": "header",
        "content": "t:sections.all.heading.label"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "t:sections.all.heading.label"
      },
      {
        "type": "select",
        "id": "heading_size",
        "options": [
          {
            "value": "h2",
            "label": "t:sections.all.heading_size.options__1.label"
          },
          {
            "value": "h1",
            "label": "t:sections.all.heading_size.options__2.label"
          },
          {
            "value": "h0",
            "label": "t:sections.all.heading_size.options__3.label"
          }
        ],
        "default": "h1",
        "label": "t:sections.all.heading_size.label"
      },
      {
        "type": "select",
        "id": "heading_alignment",
        "label": "t:sections.all.heading_alignment.label",
        "options": [
          {
            "value": "left",
            "label": "t:sections.all.heading_alignment.options__1.label"
          },
          {
            "value": "center",
            "label": "t:sections.all.heading_alignment.options__2.label"
          },
          {
            "value": "right",
            "label": "t:sections.all.heading_alignment.options__3.label"
          }
        ],
        "default": "left"
      },
      {
        "type": "inline_richtext",
        "id": "rs_description",
        "label": "Text Under Heading"
      },
      {
        "type": "select",
        "id": "mobile_text_alignment",
        "options": [
          {
            "value": "left",
            "label": "t:sections.all.mobile_layout.mobile_text_alignment.options__1.label"
          },
          {
            "value": "center",
            "label": "t:sections.all.mobile_layout.mobile_text_alignment.options__2.label"
          },
          {
            "value": "right",
            "label": "t:sections.all.mobile_layout.mobile_text_alignment.options__3.label"
          }
        ],
        "default": "left",
        "label": "Mobile heading alignment"
      },
      {
        "type": "select",
        "id": "heading_tag",
        "options": [
          {
            "value": "h1",
            "label": "t:sections.all.heading_tag.options__1.label"
          },
          {
            "value": "h2",
            "label": "t:sections.all.heading_tag.options__2.label"
          },
          {
            "value": "h3",
            "label": "t:sections.all.heading_tag.options__3.label"
          },
          {
            "value": "h4",
            "label": "t:sections.all.heading_tag.options__4.label"
          },
          {
            "value": "h5",
            "label": "t:sections.all.heading_tag.options__5.label"
          },
          {
            "value": "h6",
            "label": "t:sections.all.heading_tag.options__6.label"
          },
          {
            "value": "div",
            "label": "t:sections.all.heading_tag.options__7.label"
          },
          {
            "value": "span",
            "label": "t:sections.all.heading_tag.options__8.label"
          },
          {
            "value": "p",
            "label": "t:sections.all.heading_tag.options__9.label"
          }
        ],
        "default": "h2",
        "label": "t:sections.all.heading_tag.label",
        "info": "t:sections.all.heading_tag.info"
      },

      {
        "type": "range",
        "id": "column_num",
        "min": 2,
        "max": 5,
        "step": 1,
        "label": "Reviews on Desktop",
        "default": 4,
        "info": "This is applicable only on desktop screen greater than 1200px"
      },
      
      {
        "type": "select",
        "id": "swiper_direction",
        "label": "Column Swipe Direction",
        "options": [
          {
            "value": "false",
            "label": "Left"
          },
          {
            "value": "true",
            "label": "Right"
          },
        ],
        "default": "true"
      },
      {
        "type":"image_picker",
        "id":"trust_image",
        "label":"Trust pilot image"
      },
      {
        "type":"url",
        "id":"image_url",
        "label":"Image url"
      },
      {
        "type": "range",
        "id": "trust_image_height",
        "min": 10,
        "max": 100,
        "step": 1,
        "unit": "t:sections.all.padding.padding_top.unit",
        "label": "Trust pilot image height",
        "default": 34
      },
      {
      "type": "header",
      "content":"Additional Color"
      },
      {
        "type": "header",
        "content": "t:sections.all.colors.header.content"
      },
      {
        "type": "color",
        "id": "colors_text",
        "label": "t:sections.all.colors.colors_text.label",
        "default": "#212326"
      },
      {
        "type": "color",
        "id": "card_colors_text",
        "label": "Cards text color",
        "default": "#212326"
      },
      {
        "type": "color",
        "id": "card_colors_background",
        "label": "Cards background color",
        "default": "#ffffff"
      },
      {
        "type": "color",
        "id": "revv_bg",
        "label": "Cards background color",
        "default": "#ffffff"
      },
      {
        "type": "color",
        "id": "revv_text",
        "label": "Cards Text color",
        "default": "#ffffff"
      },
      {
        "type": "color",
        "id": "colors_background",
        "label": "t:sections.all.colors.colors_background.label",
        "default": "#ffffff"
      },
      {
        "type": "color_background",
        "id": "gradient_background",
        "label": "t:sections.all.colors.gradient_background.label"
      },
      {
        "type": "header",
        "content": "t:sections.all.padding.header.content"
      },
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 200,
        "step": 4,
        "unit": "t:sections.all.padding.padding_top.unit",
        "label": "t:sections.all.padding.padding_top.label",
        "default": 36
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 200,
        "step": 4,
        "unit": "t:sections.all.padding.padding_bottom.unit",
        "label": "t:sections.all.padding.padding_bottom.label",
        "default": 36
      },
      {
        "type": "header",
        "content": "Mobile Padding"
      },
      {
        "type": "range",
        "id": "mob_padding_top",
        "min": 0,
        "max": 200,
        "step": 4,
        "unit": "t:sections.all.padding.padding_top.unit",
        "label": "t:sections.all.padding.padding_top.label",
        "default": 36
      },
      {
        "type": "range",
        "id": "mob_padding_bottom",
        "min": 0,
        "max": 200,
        "step": 4,
        "unit": "t:sections.all.padding.padding_bottom.unit",
        "label": "t:sections.all.padding.padding_bottom.label",
        "default": 36
      }
    ],
    "blocks":[
      {
        "type":"review",
        "name":"review",
        "settings":[
          {
            "type":"image_picker",
            "id":"icon",
            "label":"icon"
          },
          {
            "type":"image_picker",
            "id":"product_image",
            "label":"Product image"
          },
          {
            "type":"richtext",
            "id":"text",
            "label":"text"
          },
          {
            "type": "select",
            "id": "text_size",
            "options": [
              {
                "value": "typeset",
                "label": "t:sections.all.text_size.options__1.label"
              },
              {
                "value": "typeset2",
                "label": "t:sections.all.text_size.options__2.label"
              },
              {
                "value": "typeset3",
                "label": "t:sections.all.text_size.options__3.label"
              }
            ],
            "default": "typeset",
            "label": "t:sections.all.text_size.label"
          },
          {
            "type":"text",
            "id":"author_title",
            "label":"Author title"
          },
          {
            "type":"text",
            "id":"product_title",
            "label":"Product title"
          },
          {
            "type":"text",
            "id":"button_label",
            "label":"Button label",
            "default":"shop now"
          },
          {
            "type":"url",
            "id":"button_link",
            "label":"Button link"
          }
        ]
      }
    ],
    "presets":[
      {
        "name":"Reviews Column v1"
      }
    ]
  }
{% endschema %}